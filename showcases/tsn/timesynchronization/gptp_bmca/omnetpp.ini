[General]
seed-set = 0
sim-time-limit = 20s
description = "abstract"

# enable time synchronization in all network nodes
*.*.hasTimeSynchronization = true

**.clock.oscillator.typename = "RandomDriftOscillator"
**.oscillator.changeInterval = 12.5ms
**.oscillator.driftRate = uniform(-100ppm, 100ppm)
**.oscillator.driftRateChange = uniform(-1ppm, 1ppm)
**.oscillator.driftRateChangeUpperLimit = 100ppm
**.oscillator.driftRateChangeLowerLimit = -100ppm

**.kp=8
**.ki=7
**.offsetThreshold = 1 us

**.pdelayInitialOffset = 1ms


# all Ethernet interfaces have 100 Mbps speed
*.*.eth[*].bitrate = 100Mbps

*.visualizer.typename = "IntegratedMultiCanvasVisualizer"
*.visualizer.infoVisualizer[*].displayInfos = true

**.gptp.gptpNodeType = "BMCA_NODE"
**.gptp.slavePort = ""
**.gptp.masterPorts = []


[Config BMCA]
network = BmcaShowcaseSimple
description = "Showcase BMCA"

*.scenarioManager.script = xmldoc("simple-link-failure.xml")


*.tsnDevice*.gptp.bmcaPorts = ["eth0"]
*.tsnSwitch.gptp.bmcaPorts = ["eth0", "eth1", "eth2"]

*.tsnDevice1.gptp.grandmasterPriority1 = 1
*.tsnDevice3.gptp.grandmasterPriority1 = 2


# Set all reference clocks to master clock so the time difference can be visualized
**.referenceClock = "tsnDevice1.clock"

# data link visualizer displays gPTP time synchronization packets
*.visualizer.dataLinkVisualizer[0].displayLinks = true
*.visualizer.dataLinkVisualizer[0].activityLevel = "protocol"
*.visualizer.dataLinkVisualizer[0].packetFilter = "GptpSync"
*.visualizer.dataLinkVisualizer[0].lineColor = "blue2"

*.visualizer.numInfoVisualizers = 3
*.visualizer.infoVisualizer[0].modules = "*.tsnClock.clock"
*.tsnDevice1.clock.displayStringTextFormat = "time: %T"
*.visualizer.infoVisualizer[1].modules = "*.tsnSwitch.clock"
*.visualizer.infoVisualizer[1].placementHint = "topLeft"
*.visualizer.infoVisualizer[2].modules = "*.tsnDevice*.clock"
*.visualizer.infoVisualizer[2].placementHint = "bottom"
*.tsnDevice*.clock.displayStringTextFormat = "diff: %d"
*.tsnSwitch.clock.displayStringTextFormat = "diff: %d"

[Config BmcaDiamondBase]
abstract=true


*.tsn*.gptp.bmcaPorts = ["eth0", "eth1"]

*.tsnDevice1.gptp.grandmasterPriority1 = 1


# Set all reference clocks to master clock so the time difference can be visualized
**.referenceClock = "tsnDevice1.clock"

# data link visualizer displays gPTP time synchronization packets
*.visualizer.dataLinkVisualizer[0].displayLinks = true
*.visualizer.dataLinkVisualizer[0].activityLevel = "protocol"
*.visualizer.dataLinkVisualizer[0].packetFilter = "GptpSync"
*.visualizer.dataLinkVisualizer[0].lineColor = "blue2"

*.visualizer.numInfoVisualizers = 3
*.visualizer.infoVisualizer[0].modules = "*.tsnClock.clock"
*.tsnDevice1.clock.displayStringTextFormat = "time: %T"
*.visualizer.infoVisualizer[1].modules = "*.tsnSwitch*.clock"
*.visualizer.infoVisualizer[1].placementHint = "topLeft"
*.visualizer.infoVisualizer[2].modules = "*.tsnDevice*.clock"
*.visualizer.infoVisualizer[2].placementHint = "bottom"
*.tsnDevice*.clock.displayStringTextFormat = "diff: %d"
*.tsnSwitch*.clock.displayStringTextFormat = "diff: %d"

[Config BmcaDiamond]
network = BmcaShowcaseDiamond
extends = BmcaDiamondBase
description = "Showcase BMCA with Diamond topology"

*.scenarioManager.script = xmldoc("diamond-link-failure.xml")


[Config BmcaDiamondAsymmetric]
network = BmcaShowcaseDiamondAsymmetric
extends = BmcaDiamondBase
description = "Showcase BMCA with asymmetric diamond topology"

*.scenarioManager.script = xmldoc("asym-diamond-link-failure.xml")
