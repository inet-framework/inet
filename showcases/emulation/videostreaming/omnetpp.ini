[General]
network = VideoStreamingShowcase
unshare-user-namespace = true
scheduler-class = "inet::RealTimeScheduler"
sim-time-limit = 225s

**.crcMode = "computed"
**.fcsMode = "computed"

*.host1.numApps = 1
*.host1.app[0].typename = "ExternalApp"
*.host1.hasEnvironment = true
*.host1.environment.setupCommand = "ip tuntap add mode tap dev tapa && " +
                                   "ip addr add 192.168.2.20/24 dev tapa && " +
                                   "ip link set dev tapa up"
*.host1.environment.teardownCommand = "ip tuntap del mode tap dev tapa"
*.host1.environment.namespace = "videostreaming"
*.host1.app[*].process.command = "setpriv --reuid=1000 --regid=1000 --clear-groups cvlc RickAstley.mkv --loop --sout '#transcode{vcodec=h264,acodec=mpga,vb=125k,ab=64k,deinterlace,scale=0.25,threads=2}:rtp{mux=ts,dst=192.168.2.99,port=4004}'"
*.host1.app[*].process.namespace = "videostreaming"

*.host2.numApps = 1
*.host2.app[0].typename = "ExternalApp"
*.host2.hasEnvironment = true
*.host2.environment.setupCommand = "ip tuntap add mode tap dev tapb && " +
                                   "ip addr add 192.168.3.20/24 dev tapb && " +
                                   "ip link set dev tapb up"
*.host2.environment.teardownCommand = "ip tuntap del mode tap dev tapb"
*.host2.environment.namespace = "videostreaming"
*.host2.app[*].process.command = "setpriv --reuid=1000 --regid=1000 --clear-groups vlc rtp://192.168.3.20:4004"
*.host2.app[*].process.namespace = "videostreaming"

*.host1.eth[0].typename = "ExtUpperEthernetInterface"
*.host1.eth[0].device = "tapa"
*.host1.eth[0].copyConfiguration = "copyFromExt"

*.host2.eth[0].typename = "ExtUpperEthernetInterface"
*.host2.eth[0].device = "tapb"
*.host2.eth[0].copyConfiguration = "copyFromExt"

*.configurator.config = xml("<config> \
                                <interface hosts='router' names='eth0' address='192.168.2.99' netmask='255.255.255.0'/> \
                                <interface hosts='router' names='eth1' address='192.168.3.99' netmask='255.255.255.0'/> \
                             </config>")
*.router.ipv4.natTable.config = xml("<config> \
                                        <entry type='prerouting' \
                                        packetFilter='has(Ipv4Header) &amp;&amp; Ipv4Header.destAddress.str() == \"192.168.2.99\"' \
                                        srcAddress='192.168.3.99' destAddress='192.168.3.20'/> \
                                     </config>")

*.visualizer.interfaceTableVisualizer.displayInterfaceTables = true
*.visualizer.interfaceTableVisualizer.nodeFilter = "not name=~switch*"

**.duplexMode = true
**.eth*.bitrate = 100Mbps