[General]
abstract = true
network = TimeSynchronizationShowcase
sim-time-limit = 10s
result-dir = "results/wip"

# all oscillators have a constant drift rate (specified with a random distribution for each one) 
# except for the master clocks, which have a random drift rate
*.*.clock.oscillator.typename = "RandomDriftOscillator"
*.*.clock.oscillator.changeInterval = 12.5ms
*.*.clock.oscillator.driftRate = uniform(-100ppm, 100ppm)
*.*.clock.oscillator.driftRateChange = uniform(-1ppm, 1ppm)
*.*.clock.oscillator.driftRateChangeUpperLimit = 100ppm
*.*.clock.oscillator.driftRateChangeLowerLimit = -100ppm

# configure  Ethernet interface speed
*.*.eth[*].bitrate = 100Mbps

# set all reference clocks to master clock so the time difference can be visualized
*.*.clock.referenceClock = "masterClock.clock"

# display time and time difference on clock modules
*.masterClock.clock.displayStringTextFormat = "time: %T"
*.device*.clock.displayStringTextFormat = "diff: %d"
*.switch.clock.displayStringTextFormat = "diff: %d"

# display time differences on network nodes
*.visualizer.infoVisualizer.displayInfos = true
*.visualizer.infoVisualizer.placementHint = "top"
*.visualizer.infoVisualizer.modules = "*.*.clock"

*.visualizer.networkNodeVisualizer.annotationSpacing = 12

[NoTimeSynchronization]
description = "Clock drift without time synchronization increases clock time differences indefinitely"

# select clock type
*.*.clock.typename = "OscillatorBasedClock"

# disable time synchronization in all network nodes
*.*.hasGptp = false
*.*.hasTimeSynchronization = false

[GptpTimeSynchronization]
description = "Clock drift with gPTP time synchronization keeps clock time differences within limits"

# enable time synchronization in all network nodes
*.*.hasGptp = true
*.*.hasTimeSynchronization = true

# configure TSN clock gPTP master ports
*.masterClock.gptp.masterPorts = ["eth0"]

# configure TSN switch gPTP bridge master ports
*.switch.gptp.masterPorts = ["eth1", "eth2"]
