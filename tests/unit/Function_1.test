%description:

This test contains basic checks for various multi-dimensional mathematical functions.

%includes:
#include "inet/common/math/Functions.h"

%global:

using namespace inet;
using namespace inet::math;
using namespace inet::units::values;

class FunctionTest
{
  public:
    void test1();
};

void FunctionTest::test1()
{
    auto backgroundNoise = makeShared<ConstantFunction<W, simtime_t, Hz>>(W(10));
    std::cout << "Background noise: " << *backgroundNoise << std::endl;
    auto transmission = makeShared<TwoDimensionalBoxcarFunction<W, simtime_t, Hz>>(10, 30, GHz(0.9), GHz(1.1), W(100));
    std::cout << "Transmission: " << *transmission << std::endl;
    auto propagation = Point<simtime_t, Hz> (10, Hz(0));
    std::cout << "Propagation: " << propagation << std::endl;
    auto attenuation = makeShared<ConstantFunction<double, simtime_t, Hz>>(0.5);
    std::cout << "Attenuation: " << *attenuation << std::endl;
    auto propagatedTransmission = makeShared<ShiftFunction<W, simtime_t, Hz>>(transmission, propagation);
    auto reception = propagatedTransmission->multiply(attenuation);
    std::cout << "Reception: " << *reception << std::endl;
    auto snir = reception->divide(backgroundNoise);
    std::cout << "SNIR: " << *snir << std::endl;
}

%activity:
FunctionTest tester;
tester.test1();

%contains: stdout
Background noise: f {
  i [(-4611686.018427387903, -inf Hz) ... (4611686.018427387903, inf GHz)] -> { @(-4611686.018427387903, -inf Hz) = 10 W, @(4611686.018427387903, -inf Hz) = 10 W, @(-4611686.018427387903, inf GHz) = 10 W, @(4611686.018427387903, inf GHz) = 10 W, min = 10 W, max = 10 W, mean = 10 W }
} min = 10 W, max = 10 W, mean = 10 W
Transmission: f {
  i [(-4611686.018427387903, -inf Hz) ... (10, 900 MHz)] -> { @(-4611686.018427387903, -inf Hz) = 0 W, @(10, -inf Hz) = 0 W, @(-4611686.018427387903, 900 MHz) = 0 W, @(10, 900 MHz) = 100 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(10, -inf Hz) ... (30, 900 MHz)] -> { @(10, -inf Hz) = 0 W, @(30, -inf Hz) = 0 W, @(10, 900 MHz) = 100 W, @(30, 900 MHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(30, -inf Hz) ... (4611686.018427387903, 900 MHz)] -> { @(30, -inf Hz) = 0 W, @(4611686.018427387903, -inf Hz) = 0 W, @(30, 900 MHz) = 0 W, @(4611686.018427387903, 900 MHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(-4611686.018427387903, 900 MHz) ... (10, 1.1 GHz)] -> { @(-4611686.018427387903, 900 MHz) = 0 W, @(10, 900 MHz) = 100 W, @(-4611686.018427387903, 1.1 GHz) = 0 W, @(10, 1.1 GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(10, 900 MHz) ... (30, 1.1 GHz)] -> { @(10, 900 MHz) = 100 W, @(30, 900 MHz) = 0 W, @(10, 1.1 GHz) = 0 W, @(30, 1.1 GHz) = 0 W, min = 100 W, max = 100 W, mean = 100 W }
  i [(30, 900 MHz) ... (4611686.018427387903, 1.1 GHz)] -> { @(30, 900 MHz) = 0 W, @(4611686.018427387903, 900 MHz) = 0 W, @(30, 1.1 GHz) = 0 W, @(4611686.018427387903, 1.1 GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(-4611686.018427387903, 1.1 GHz) ... (10, inf GHz)] -> { @(-4611686.018427387903, 1.1 GHz) = 0 W, @(10, 1.1 GHz) = 0 W, @(-4611686.018427387903, inf GHz) = 0 W, @(10, inf GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(10, 1.1 GHz) ... (30, inf GHz)] -> { @(10, 1.1 GHz) = 0 W, @(30, 1.1 GHz) = 0 W, @(10, inf GHz) = 0 W, @(30, inf GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(30, 1.1 GHz) ... (4611686.018427387903, inf GHz)] -> { @(30, 1.1 GHz) = 0 W, @(4611686.018427387903, 1.1 GHz) = 0 W, @(30, inf GHz) = 0 W, @(4611686.018427387903, inf GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
} min = 0 W, max = 100 W, mean = 0 W
Propagation: (10, 0 Hz)
Attenuation: f {
  i [(-4611686.018427387903, -inf Hz) ... (4611686.018427387903, inf GHz)] -> { @(-4611686.018427387903, -inf Hz) = 0.5, @(4611686.018427387903, -inf Hz) = 0.5, @(-4611686.018427387903, inf GHz) = 0.5, @(4611686.018427387903, inf GHz) = 0.5, min = 0.5, max = 0.5, mean = 0.5 }
} min = 0.5, max = 0.5, mean = 0.5
Reception: f {
  i [(-4611676.018427387903, -inf Hz) ... (20, 900 MHz)] -> { @(-4611676.018427387903, -inf Hz) = 0 W, @(20, -inf Hz) = 0 W, @(-4611676.018427387903, 900 MHz) = 0 W, @(20, 900 MHz) = 50 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(20, -inf Hz) ... (40, 900 MHz)] -> { @(20, -inf Hz) = 0 W, @(40, -inf Hz) = 0 W, @(20, 900 MHz) = 50 W, @(40, 900 MHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(40, -inf Hz) ... (4611686.018427387903, 900 MHz)] -> { @(40, -inf Hz) = 0 W, @(4611686.018427387903, -inf Hz) = 0 W, @(40, 900 MHz) = 0 W, @(4611686.018427387903, 900 MHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(-4611676.018427387903, 900 MHz) ... (20, 1.1 GHz)] -> { @(-4611676.018427387903, 900 MHz) = 0 W, @(20, 900 MHz) = 50 W, @(-4611676.018427387903, 1.1 GHz) = 0 W, @(20, 1.1 GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(20, 900 MHz) ... (40, 1.1 GHz)] -> { @(20, 900 MHz) = 50 W, @(40, 900 MHz) = 0 W, @(20, 1.1 GHz) = 0 W, @(40, 1.1 GHz) = 0 W, min = 50 W, max = 50 W, mean = 50 W }
  i [(40, 900 MHz) ... (4611686.018427387903, 1.1 GHz)] -> { @(40, 900 MHz) = 0 W, @(4611686.018427387903, 900 MHz) = 0 W, @(40, 1.1 GHz) = 0 W, @(4611686.018427387903, 1.1 GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(-4611676.018427387903, 1.1 GHz) ... (20, inf GHz)] -> { @(-4611676.018427387903, 1.1 GHz) = 0 W, @(20, 1.1 GHz) = 0 W, @(-4611676.018427387903, inf GHz) = 0 W, @(20, inf GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(20, 1.1 GHz) ... (40, inf GHz)] -> { @(20, 1.1 GHz) = 0 W, @(40, 1.1 GHz) = 0 W, @(20, inf GHz) = 0 W, @(40, inf GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
  i [(40, 1.1 GHz) ... (4611686.018427387903, inf GHz)] -> { @(40, 1.1 GHz) = 0 W, @(4611686.018427387903, 1.1 GHz) = 0 W, @(40, inf GHz) = 0 W, @(4611686.018427387903, inf GHz) = 0 W, min = 0 W, max = 0 W, mean = 0 W }
} min = 0 W, max = 50 W, mean = 0 W
SNIR: f {
  i [(-4611676.018427387903, -inf Hz) ... (20, 900 MHz)] -> { @(-4611676.018427387903, -inf Hz) = 0, @(20, -inf Hz) = 0, @(-4611676.018427387903, 900 MHz) = 0, @(20, 900 MHz) = 5, min = 0, max = 0, mean = 0 }
  i [(20, -inf Hz) ... (40, 900 MHz)] -> { @(20, -inf Hz) = 0, @(40, -inf Hz) = 0, @(20, 900 MHz) = 5, @(40, 900 MHz) = 0, min = 0, max = 0, mean = 0 }
  i [(40, -inf Hz) ... (4611686.018427387903, 900 MHz)] -> { @(40, -inf Hz) = 0, @(4611686.018427387903, -inf Hz) = 0, @(40, 900 MHz) = 0, @(4611686.018427387903, 900 MHz) = 0, min = 0, max = 0, mean = 0 }
  i [(-4611676.018427387903, 900 MHz) ... (20, 1.1 GHz)] -> { @(-4611676.018427387903, 900 MHz) = 0, @(20, 900 MHz) = 5, @(-4611676.018427387903, 1.1 GHz) = 0, @(20, 1.1 GHz) = 0, min = 0, max = 0, mean = 0 }
  i [(20, 900 MHz) ... (40, 1.1 GHz)] -> { @(20, 900 MHz) = 5, @(40, 900 MHz) = 0, @(20, 1.1 GHz) = 0, @(40, 1.1 GHz) = 0, min = 5, max = 5, mean = 5 }
  i [(40, 900 MHz) ... (4611686.018427387903, 1.1 GHz)] -> { @(40, 900 MHz) = 0, @(4611686.018427387903, 900 MHz) = 0, @(40, 1.1 GHz) = 0, @(4611686.018427387903, 1.1 GHz) = 0, min = 0, max = 0, mean = 0 }
  i [(-4611676.018427387903, 1.1 GHz) ... (20, inf GHz)] -> { @(-4611676.018427387903, 1.1 GHz) = 0, @(20, 1.1 GHz) = 0, @(-4611676.018427387903, inf GHz) = 0, @(20, inf GHz) = 0, min = 0, max = 0, mean = 0 }
  i [(20, 1.1 GHz) ... (40, inf GHz)] -> { @(20, 1.1 GHz) = 0, @(40, 1.1 GHz) = 0, @(20, inf GHz) = 0, @(40, inf GHz) = 0, min = 0, max = 0, mean = 0 }
  i [(40, 1.1 GHz) ... (4611686.018427387903, inf GHz)] -> { @(40, 1.1 GHz) = 0, @(4611686.018427387903, 1.1 GHz) = 0, @(40, inf GHz) = 0, @(4611686.018427387903, inf GHz) = 0, min = 0, max = 0, mean = 0 }
} min = 0, max = 5, mean = 0
