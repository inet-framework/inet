%description:
Testing DHCP protocol

%#--------------------------------------------------------------------------------------------------------------
%file: test.ned

import inet.networklayer.autorouting.ipv4.IPv4NetworkConfigurator;
import inet.nodes.inet.StandardHost;
import ned.DatarateChannel;

network Dhcptest
{
    types:
        channel C extends DatarateChannel
        {
            delay = 0.1us;
            datarate = 10Mbps;
        }
    submodules:
        configurator: IPv4NetworkConfigurator {
            parameters:
                config = xml("<config><interface hosts='dhcpServer' address='192.168.1.1' netmask='255.255.255.0' /></config>");
        }
        dhcpClient: StandardHost {
            parameters:
                numUdpApps = 1;
                udpApp[0].typename = "DHCPClient";
                @display("p=66,76");
        }
        dhcpServer: StandardHost {
            parameters:
                numUdpApps = 1;
                udpApp[0].typename = "DHCPServer";
                @display("p=277,76");
        }
    connections:
        dhcpClient.pppg++ <--> C <--> dhcpServer.pppg++;
}

%#--------------------------------------------------------------------------------------------------------------
%inifile: omnetpp.ini

[General]

tkenv-plugin-path = ../../../etc/plugins
ned-path = .;../../../../src;../../lib

network = Dhcptest

sim-time-limit = 10500s
cmdenv-express-mode = true

**.dhcpServer.udpApp[0].typename = "DHCPServer"
**.dhcpServer.udpApp[0].subnetMask = "255.255.255.0"        # netmask to assign
**.dhcpServer.udpApp[0].ipAddressStart = "192.168.1.100"    # ip to start to lease
**.dhcpServer.udpApp[0].maxNumClients = 100     # number of ip to lease
**.dhcpServer.udpApp[0].gateway = "192.168.1.1"     # gateway to assign
**.dhcpServer.udpApp[0].dns = ""         # dns to assign
**.dhcpServer.udpApp[0].leaseTime = 1000s     # lease time in seconds

%#--------------------------------------------------------------------------------------------------------------
%#--------------------------------------------------------------------------------------------------------------
%contains-regex: stdout

     Messages:  created: \d+   present: \d+   in FES: \d+
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
Host dhcpClient got ip: 192\.168\.1\.100/255\.255\.255\.0
\*\* Event

%#--------------------------------------------------------------------------------------------------------------
%not-contains: stdout
undisposed object:
%not-contains: stdout
-- check module destructor
%#--------------------------------------------------------------------------------------------------------------