#
# Copyright (C) 2013 Kyeong Soo (Joseph) Kim. All rights reserved.
#
# This ini file provides architecture-specific configurations for an
# abstract model of shared access architectures -- like TDM-PONs or
# DOCSIS cable Internet access -- for the comparison study of
# next-generation network (NGN) access architectures.
#
# Note that [General] section, i.e., configurations common to all
# architectures including those of traffic models, is provided by
# "General.ini".
#


[General]
### [General] section providing configurations common to all network architectures
include General.ini


########################################################################
### Architecture-Specific Settings
########################################################################
[Config Base]
### General
result-dir = results/mixed
sim-time-limit = 100s
#sim-time-limit = 80s
warmup-period = 0s
**.thruputMeter.measurementInterval = 1s		# throughput measurement interval (default is 1s)
#**.olt.mac[0].queue.*.vector-recording = true	# for debugging of DRR/CSFQ algorithms
repeat = 1
### Network configuraion
*.N = ${N=16}
**.olt.numSubscribers = ${N}
**.olt.mac[0].queue.numFlows = ${N}
**.olt.mac[0].queue.vids = "10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25"
### Server
**.server.numFtpSrvs = 1
**.server.numUdpApps = 12
**.server.udpApp[*].lineRate = ${br}Mbps	# backbone rate
**.server.udpApp[*].messageLength = 950B	# resulting in 1000-byte Ethernet frame (i.e., UDP(8)+IP(20)+Ethernet(22))
#**.server.udpApp[*].messagePeriod = exponential(1s)
#**.server.udpApp[*].startTime = uniform(0s, 1s)
### TBM
**.olt.mac[0].meter[*].bucketSize = 1000000B	# 1 MB
#**.olt.mac[0].meter[*].bucketSize = 10000B		# 10 kB
**.olt.mac[0].meter[*].peakRate = ${br}Mbps		# It should be set to the backbone rate, not the distribution rate,
												# because we now use metering, not shaping.
### TCP
**.tcp.windowScalingSupport = true	# enable window scaling support to provide throughput greater than 6Mbps
**.tcp.advertisedWindow = 65535*100
**.tcp.sackSupport = true
### Flows
# Group 1: UDP (CBR) with SR=16Mbps & TGR=2.5Mbps
**.server.udpApp[0].destAddresses = "host[0]"
**.server.udpApp[1].destAddresses = "host[1]"
**.server.udpApp[2].destAddresses = "host[2]"
**.server.udpApp[3].destAddresses = "host[3]"
**.server.udpApp[0..3].startTime = 0.0s
**.server.udpApp[0..3].messagePeriod = 0.5ms
**.olt.mac[0].meter[0..3].meanRate = 2.5Mbps
## Group 2: UDP (CBR) with SR=16Mbps & TGR=5Mbps
**.server.udpApp[4].destAddresses = "host[4]"
**.server.udpApp[5].destAddresses = "host[5]"
**.server.udpApp[6].destAddresses = "host[6]"
**.server.udpApp[7].destAddresses = "host[7]"
**.server.udpApp[4..7].startTime = 25.0s
**.server.udpApp[4..7].messagePeriod = 0.5ms
**.olt.mac[0].meter[4..7].meanRate = 5Mbps
## Group 3: UDP (CBR) with SR=16Mbps & TGR=7.5Mbps
**.server.udpApp[8].destAddresses = "host[8]"
**.server.udpApp[9].destAddresses = "host[9]"
**.server.udpApp[10].destAddresses = "host[10]"
**.server.udpApp[11].destAddresses = "host[11]"
**.server.udpApp[8..11].startTime = 50.0s
**.server.udpApp[8..11].messagePeriod = 0.5ms
**.olt.mac[0].meter[8..11].meanRate = 7.5Mbps
## Group 4: Greedy TCP with TGR=10Mbps
**.host[12..15].numFtpApps = 1
**.host[12..15].numUdpApps = 0
**.host[12..15].ftpApp[*].fileSize = 1GiB	# to emulate greedy source
**.host[12..15].ftpApp[*].startTime = 75.0s
**.olt.mac[0].meter[12..15].meanRate = 10Mbps
#**.olt.mac[0].meter[12..15].meanRate = 9.5Mbps

[Config drr]
extends = Base
**.olt.mac[0].queueType = "DRRVLANQueue2"	# OLT downstream queue
#**.olt.mac[0].queueType = "DRRVLANQueue"	# OLT downstream queue
**.olt.mac[0].queue.voqSize = ${qs=1000000}B	# 1 MB
#**.olt.mac[0].queue.voqSize = ${qs=4000000}B	# 4 MB
**.olt.mac[0].queue.quanta = "1522 1522 1522 1522 3044 3044 3044 3044 4566 4566 4566 4566 6088 6088 6088 6088"
#**.olt.mac[0].queue.quanta = "250 250 250 250 500 500 500 500 750 750 750 750 1000 1000 1000 1000"

[Config csfq]
extends = Base
**.olt.mac[0].queueType = "CSFQVLANQueue"	# OLT downstream queue
**.olt.mac[0].queue.queueSize = ${qs=($N)*1000000}*1B	# FIFO queue size - 16MB

[Config csfq5]
extends = Base
#**.olt.mac[0].queueType = "CSFQVLANQueue4"	# OLT downstream queue
**.olt.mac[0].queueType = "CSFQVLANQueue5"	# OLT downstream queue
**.olt.mac[0].queue.queueSize = ${qs=($N)*1000000}*1B	# FIFO queue size - 16MB
**.olt.mac[0].queue.queueThreshold = 64000B	# 64KB
#**.olt.mac[0].queue.queueThreshold = int(0.25*{$qs})*1B	# quarter of queue size
#**.olt.mac[0].queue.thresholdScaleFactor = 0.2
**.olt.mac[0].queue.max_alpha = -1 # turn off fair share rate decrease based on buffer overflow
#**.olt.mac[0].queue.max_beta = -1  # turn off fair share rate decrease based on queue size & queue threshold
